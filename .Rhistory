data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "No-paramétrico"), data = non_par) +
labs(x = "Tiempo (Días)",
y = "Riesgo Acumulado", col = "Model") + scale_color_manual(values = c("red", "blue", "black"))
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "No-paramétrico"), data = non_par) +
labs(x = "Tiempo (Días)",
y = "Riesgo Acumulado", col = "Model") + scale_color_viridis_d()
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "No-paramétrico"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "") + scale_color_viridis_d()
help(labs)
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "", tag = "top") + scale_color_viridis_d()
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "") + scale_color_viridis_d()
surv_input = list(flexg_weibull, flexg_lnorm, flexg_gamma,
flexg_loglogis, flexg_gompertz, flexg_exp)
dist_surv <- c("Weibull", "Log-normal",
"Generalized Gamma", "Log-Logistic",
"Gompertz", "Exponential")
surv_input = list(flexg_weibull, flexg_lnorm, flexg_gamma,
flexg_loglogis, flexg_gompertz, flexg_exp)
names(surv_input) = dist_surv
# Curvas de supervivencia
dist_surv <- c("Weibull", "Log-normal",
"Generalized Gamma", "Log-Logistic",
"Gompertz", "Exponential")
surv_input = list(flexg_weibull, flexg_lnorm, flexg_gamma,
flexg_loglogis, flexg_gompertz, flexg_exp)
names(surv_input) = dist_surv
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()
+ theme(legend.position = c(0.2, 0. 8))
+ theme(legend.position = c(0.2, 0.8))
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(legend.position = c(0.2, 0.8))
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(legend.position = c(0.2, 0.8), fill = "")
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(legend.position = c(0.2, 0.8), fill = NA)
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(legend.position = c(0.2, 0.8), fill = "gray")
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(
legend.position = c(0.2, 0.8), legend.background = element_blank()
)
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(
legend.position = c(0.8, 0.8), legend.background = element_blank()
)
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(
legend.position = c(0.7, 0.8), legend.background = element_blank()
)
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(
legend.position = c(0.8, 0.7), legend.background = element_blank()
)
# Curvas de supervivencia
dist_surv <- c("Weibull", "Log-normal",
"Generalized Gamma", "Log-Logistic",
"Gompertz", "Exponential")
surv_input = list(flexg_weibull, flexg_lnorm, flexg_gamma,
flexg_loglogis, flexg_gompertz, flexg_exp)
names(surv_input) = dist_surv
data.Surv <- Surv(dataset$t_UCI, dataset$d)
modelo_general <- sapply(dist, function(x) flexsurvreg(data.Surv ~ 1, dist = x), USE.NAMES = T, simplify = F)
png(file = "Paper_resultados/Parametric_model/Survival_rate/Output/Parametric_model_vs.png",
width = 900, height = 700)
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(
legend.position = c(0.8, 0.7), legend.background = element_blank()
)
dev.off()
# Funciones de riesgo acumulado
dist_hazard <- dist_surv
hazard_input = dist_input
names(hazard_input) = dist_hazard
png(file = "Paper_resultados/Parametric_model/Survival_rate/Output/Hazard_model_vs.png",
width = 900, height = 700)
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "") + scale_color_viridis_d() + theme(
legend.position = c(0.8, 0.7), legend.background = element_blank()
)
dev.off()
dist
##########################################
## (Criterio de información de Akaike)  ##
##########################################
dist = c("weibull", "lnorm", "GenGamma.orig",
"llogis", "gompertz", "exp")
data_surv <- Surv(dataset$t_UCI, dataset$d)
modelo <- sapply(dist,
function(x) flexsurvreg(data_surv ~ 1, data = dataset, dist = x),
USE.NAMES = T, simplify = F)
IC_model <- sapply(modelo, function(x) c(AIC = AIC(x), BIC = BIC(x), LogLik = logLik(x)), simplify = T)
IC_model[, order(IC_model["AIC", ])]
png(file = "Paper_resultados/Parametric_model/Survival_rate/Output/Hazard_model_vs.png",
width = 900, height = 700)
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "") + scale_color_viridis_d() + theme(
legend.position = c(0.8, 0.3), legend.background = element_blank()
)
dev.off()
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "") + scale_color_viridis_d() + theme(
legend.position = c(0.8, 0.3), legend.background = element_blank()
)
dev.off()
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "") + scale_color_viridis_d() + theme(
legend.position = c(0.8, 0.3), legend.background = element_blank()
)
png(file = "Paper_resultados/Parametric_model/Survival_rate/Output/Parametric_model_vs.png",
width = 500, height = 450)
ggplot() + geom_line(aes(time, (est),
col = names(surv_input)[1]),
data = surv_input[[1]],
) + geom_line(aes(time, (est),
col = names(surv_input)[2]),
data = surv_input[[2]],
) + geom_line(aes(time, (est),
col = names(surv_input)[3]),
data = surv_input[[3]],
) + geom_line(aes(time, (est),
col = names(surv_input)[4]),
data = surv_input[[4]],
) + geom_line(aes(time, (est),
col = names(surv_input)[5]),
data = surv_input[[5]],
) + geom_line(aes(time, (est),
col = names(surv_input)[6]),
data = surv_input[[6]],
) + geom_step(aes(time, (surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Survival probability", col = "") + scale_color_viridis_d()+ theme(
legend.position = c(0.8, 0.7), legend.background = element_blank()
)
dev.off()
# Funciones de riesgo acumulado
dist_hazard <- dist_surv
hazard_input = dist_input
names(hazard_input) = dist_hazard
png(file = "Paper_resultados/Parametric_model/Survival_rate/Output/Hazard_model_vs.png",
width = 500, height = 450)
ggplot() + geom_line(aes(time, -log(est),
col = names(hazard_input)[1]),
data = hazard_input[[1]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[2]),
data = hazard_input[[2]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[3]),
data = hazard_input[[3]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[4]),
data = hazard_input[[4]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[5]),
data = hazard_input[[5]],
) + geom_line(aes(time, -log(est),
col = names(hazard_input)[6]),
data = hazard_input[[6]],
) + geom_step(aes(time, -log(surv), col = "Kaplan-Meier"), data = non_par) +
labs(x = "Time since admission to ICU (days)",
y = "Cumulative Hazard", col = "") + scale_color_viridis_d() + theme(
legend.position = c(0.8, 0.3), legend.background = element_blank()
)
dev.off()
